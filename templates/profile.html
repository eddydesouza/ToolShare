{% extends "base.html" %}

{% block title %}User Profile | ToolShare{% endblock %}

{% block content %}

  <h2 class="mb-4">Edit Profile</h2>

  <form action="{{ url_for('user.update_profile') }}" method="post" class="row g-3" novalidate>
    <input type="hidden" name="user_id" value="{{ user.id }}">

    <div class="col-md-6">
      <label class="form-label">First Name</label>
      <input type="text" class="form-control" name="first_name" value="{{ user.first_name }}" required>
    </div>

    <div class="col-md-6">
      <label class="form-label">Last Name</label>
      <input type="text" class="form-control" name="last_name" value="{{ user.last_name }}" required>
    </div>

    <div class="col-md-6">
      <label class="form-label">Email</label>
      <input type="email" class="form-control" name="email" value="{{ user.email }}" required>
    </div>

    <div class="col-md-6">
      <label class="form-label">Phone <small class="text-muted">(e.g., 555-123-4567)</small></label>
      <input type="tel" class="form-control" name="phone" value="{{ user.phone }}"
             pattern="^\(?\d{3}\)?[-.\s]?\d{3}[-.\s]?\d{4}$"
             title="Enter a valid US phone number (e.g., 555-123-4567)">
    </div>

    <div class="col-12">
      <label class="form-label">Address Line 1</label>
      <input type="text" class="form-control" name="address_line1" value="{{ user.address_line1 }}">
    </div>

    <div class="col-md-4">
      <label class="form-label">City</label>
      <input type="text" class="form-control" name="city" value="{{ user.city }}">
    </div>

    <div class="col-md-4">
      <label class="form-label">State <small class="text-muted">(e.g., TX)</small></label>
      <input type="text" class="form-control" name="state" value="{{ user.state }}"
             pattern="^[A-Za-z]{2}$" maxlength="2"
             title="Use a 2-letter state abbreviation (e.g., TX)">
    </div>

    <div class="col-md-4">
      <label class="form-label">Zip Code</label>
      <input type="text" class="form-control" name="zip_code" value="{{ user.zip_code }}"
             pattern="^\d{5}(-\d{4})?$"
             title="Enter a valid 5-digit ZIP or ZIP+4 (e.g., 12345 or 12345-6789)">
    </div>

    <div class="col-12 d-flex align-items-center gap-3 mt-4">
      <button type="submit" class="btn btn-success">Update Profile</button>
      <a href="{{ url_for('index') }}" class="btn btn-secondary">Return Home</a>
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% for category, message in messages %}
          {% if category == 'success' %}
            <span class="text-success fw-bold ms-2">{{ message }}</span>
          {% endif %}
        {% endfor %}
      {% endwith %}
    </div>
  </form>

{% endblock %}
